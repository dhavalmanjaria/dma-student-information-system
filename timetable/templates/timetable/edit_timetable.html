{% extends "base-action-page.html" %}

{% block header_title %}
Edit Time Table for {{ semester }}
{% endblock %}

{% block additional_left_sidebar %}
    <ul class="list-group">
    <li class="list-group-item">
        <a class="btn" href="{% url 'view-timetable' pk=semester.pk %}">View Timetable</a>
    </li>
    <li class="list-group-item">
        <a class="btn" href="{% url 'edit-times' pk=semester.pk %}">Edit Times</a>
    </li>
    <li class="list-group-item">
        <a class="btn btn-info btn-sm" href="{% url 'edit-days' pk=semester.pk day='add' %}">Add New Day</a>
    </li>
    <li class="list-group-item">
        <a class="btn btn-danger btn-sm" href="{% url 'edit-days' pk=semester.pk day='remove' %}">Delete Last Day</a>
    </li>
    </ul>
{% endblock %}

{% block content %}
<div class="panel panel-info">
<div class="panel-heading">Edit time table for <strong>{{ semester }}</strong> </div>
<div id="panel-body">
    <form action="{% url 'edit-timetable' pk=semester.pk %}" method="POST" id="tt-form" class="form-group">
    {% csrf_token %}
    <table class="table">
        <thead>
            <tr>
                <th>
                </th>
                
                {% for t in formatted_times %}
                    <th>{{ t|time:"g:i A"}}</th>
                {% endfor %}

            </tr>
        </thead>
        <tbody>
            {% for row, cells in timetable.items %}
                <tr>
                    <td><strong>{{ row }}</strong></td>
                    {% for cell in cells %}
                        <td>
                            <select class="form-control" name="{{ row }}" form="tt-form">
                                {% for sub in subjects %}
                                    {# This just seems more readable than having an if statement inline #}
                                    {% if cell == sub %}
                                        <option value="{{ sub.pk }}" selected>
                                            {{ sub }}
                                        </option>

                                        {% else %}
                                        <option value="{{ sub.pk }}" >
                                            {{ sub }}
                                        </option>            
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </td>
                    {% endfor %}
                </tr>    
            {% endfor %}
            
        </tbody>
    </table>
    <div class="panel-body">
        <input type="submit" value="Save" class="btn btn-primary" />
    </div>

    </form>
</div>
</div>
{% endblock %}